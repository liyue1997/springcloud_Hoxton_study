(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{glNB:function(e,t,n){},y3Ti:function(e,t,n){"use strict";var a=n("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("y8nQ");var l=a(n("Vl3Y")),u=a(n("p0pE"));n("2qtc");var o=a(n("kLXV"));n("Pwec");var d=a(n("CtXQ"));n("14J3");var s=a(n("BMrR"));n("miYZ");var r=a(n("tsqr")),i=a(n("2Taf")),c=a(n("vZ4D")),m=a(n("l4Ni")),f=a(n("rlhR")),p=a(n("ujKo")),b=a(n("2Q78")),h=a(n("MhPg"));n("B9cy");var y=a(n("Ol7k"));n("ozfa");var g=a(n("MJZm")),C=a(n("q1tI")),k=n("Hg0r"),v=n("ACwk");n("glNB");var M=n("tlgq"),E=n("6LiA"),j=a(n("d/P1")),_=g.default.TreeNode,N=(y.default.Sider,y.default.Content,{className:"test"}),S=function(e){function t(){var e;return(0,i.default)(this,t),e=(0,m.default)(this,(0,p.default)(t).apply(this,arguments)),e.getdata=function(){var t=e.props.dispatch;t({type:"mcommonobject/queryData",params:{len:1e3,page:1,url:e.getObjectName()+"/query"+e.getObjectName()+"List"},callback:function(t){console.log("mcommonobject/queryData",t),t.data&&t.data.list?(e.setState({dataSource:t.data.list,curObj:{},edit:"none"}),e.props.form.resetFields()):r.default.error("\u672a\u83b7\u53d6\u5230\u6570\u636e")}})},e.getRows=function(){var t=e.props.mtsSubsys.data,n=C.default.createElement(s.default,null,e.getColInput("\u83dc\u5355\u7f16\u53f7:","menuCode",e.getInputOnlyAdd(),!0),e.getCol("\u83dc\u5355\u540d\u79f0:","menuName",!0),e.getColInput("\u662f\u5426\u5b50\u8282\u70b9:","isLeaf",(0,E.selectIsUsed)(),!0),e.getCol("\u83dc\u5355\u5c42\u7ea7:","menuLevel"),e.getCol("\u83dc\u5355\u56fe\u7247:","menuIcon"),e.getCol("\u83dc\u5355\u987a\u5e8f:","menuOrder",!0),e.getCol("\u6a21\u5757\u7f16\u7801:","moduleId"),e.getCol("\u7236\u83dc\u5355\u7f16\u7801:","parentMenuCode"),e.getColInput("\u5b50\u7cfb\u7edf\u7f16\u7801:","subsysId",C.default.createElement(j.default,{tsSubsys:t}),!0),e.getCol("\u83dc\u5355\u53c2\u6570:","menuArgs"));return n},e.returnBack=function(){e.getdata(),e.setState({moduleCode:e.props.location.query.moduleCode,edit:"none",objid:""})},e.onRightClick=function(t){e.selectNode(t.node)},e.onSelect=function(t,n){e.selectNode(n.node)},e.getMenus=function(t){switch(t){case 0:return C.default.createElement(v.ContextMenu,{id:"some_unique_identifier"},C.default.createElement(v.MenuItem,null));case 1:return C.default.createElement(v.ContextMenu,{id:"some_unique_identifier"},C.default.createElement(v.MenuItem,null));case 2:return C.default.createElement(v.ContextMenu,{id:"some_unique_identifier"},C.default.createElement(v.MenuItem,{data:{action:"addson"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"plus"}),"\u65b0\u5efa\u5b50\u83dc\u5355"),C.default.createElement(v.MenuItem,{data:{action:"deleteallchild"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"delete"}),"\u5220\u9664\u6240\u6709\u5b50\u83dc\u5355"));default:return C.default.createElement(v.ContextMenu,{id:"some_unique_identifier"},C.default.createElement(v.MenuItem,{data:{action:"addson"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"plus"}),"\u65b0\u5efa\u5b50\u83dc\u5355"),C.default.createElement(v.MenuItem,{data:{action:"addbrother"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"plus"}),"\u65b0\u5efa\u540c\u7ea7\u83dc\u5355"),C.default.createElement(v.MenuItem,{data:{action:"delete"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"delete"}),"\u5220\u9664\u83dc\u5355"),C.default.createElement(v.MenuItem,{data:{action:"deleteallchild"},attributes:N,onClick:e.rightmenuClick},C.default.createElement(d.default,{type:"delete"}),"\u5220\u9664\u6240\u6709\u5b50\u83dc\u5355"))}},e.getChildrenNode=function(t){var n=t.props.children;if(n){var a=[t.props.eventKey];return n.map(function(t){void 0!=t&&(a.push(t.key),e.getChildrenNode(t))}),a}},e.delSelectChildMenu=function(t,n){var a=e.state.dataSource||[],l=[];n>2?a.map(function(e){e.parent_menu_code==t&&l.push(e.menu_code)}):a.map(function(e){e.subsys_id==t&&l.push(e.menu_code)}),e.handleDelete(l)},e.delSelectMenu=function(t){var n=[];n.push(t),e.handleDelete(n)},e.handleDelete=function(t){var n=(0,f.default)(e);o.default.confirm({title:"\u786e\u5b9a\u5220\u9664\u5417?",okType:"danger",okText:"\u662f",cancelText:"\u5426",onOk:function(){n.props.dispatch({type:"mcommonobject/deleteobjs",ids:t,params:{objUrl:n.state.objUrl},callback:function(e){"202"===e["code"]?(r.default.success("\u5220\u9664\u6210\u529f"),n.getdata()):r.default.error(e["msg"]||"\u672a\u77e5\u9519\u8bef")}})},onCancel:function(){}})},e.newmenu=function(t){(0,f.default)(e);var n=e.props.dispatch;n({type:"mcommonobject/newobj",params:{objUrl:e.state.objUrl},callback:function(n){"200"==n.code?e.setState({curObj:(0,u.default)({},n.data,t),edit:"add"}):r.default.error(n.msg||"\u672a\u77e5\u7cfb\u7edf\u5f02\u5e38")}})},e.rightmenuClick=function(t,n){var a=e.state.curObj||{},l=e.state.selectedNode,u=n.action,o=null==l?"":l["props"]["eventKey"],d=null==l?0:l["props"]["pos"].split("-").length-1;switch(u){case"addson":2==d?e.newmenu({subsysId:o,parentMenuCode:"",isLeaf:0}):d>2&&e.newmenu({subsysId:a["subsysId"],parentMenuCode:o,isLeaf:1});break;case"addbrother":d>2&&e.newmenu({subsysId:a["subsysId"],parentMenuCode:a["parentMenuCode"],isLeaf:a["isLeaf"]});break;case"delete":e.delSelectMenu(o);break;case"deleteallchild":e.delSelectChildMenu(o,d);break}},e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getObjectName",value:function(){return"TsMenuModule"}},{key:"getDefaultValues",value:function(){return{}}},{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"mtsSubsys/queryAll"}),this.setState({moduleCode:this.props.location.query.moduleCode,edit:"none",objid:""}),this.getdata()}},{key:"getMenuTreeNode",value:function(e,t,n){var a=this;return n?n.map(function(l){if(l.subsys_id==e&&l.parent_menu_code==t)return C.default.createElement(_,{title:l.menu_code+l.menu_name,key:l.menu_code},a.getMenuTreeNode(e,l.menu_code,n))}):null}},{key:"selectNode",value:function(e){var t=this;console.log("selectNode",e);var n=e.props.pos.split("-").length-1;switch(this.props.form.resetFields(),n){case 1:this.setState({selectedNode:e,curObj:{},objid:"",edit:"none"});break;case 2:this.setState({selectedNode:e,curObj:{},objid:"",edit:"none"});break;default:var a=this.state.dataSource;console.log("\u83dc\u5355",a);var l=this.props.dispatch;l({type:"mcommonobject/getobj",params:{objUrl:this.state.objUrl,id:e.props.eventKey},callback:function(n){"200"==n.code?t.setState({selectedNode:e,curObj:n.data||{},objid:e.props.eventKey,edit:"update"}):r.default.error(n.msg||"\u83b7\u53d6\u6570\u636e\u5931\u8d25!")}});break}}},{key:"render",value:function(){var e=this,n=this.props.mtsSubsys.data,a=this.state.dataSource,l=this.state.selectedNode,u=[null==l?"":l["props"]["eventKey"]],o=null==l?0:l.props.pos.split("-").length-1;return console.log("render",this.props),C.default.createElement("div",{className:"mainTreediv"},C.default.createElement("div",{className:"sideTree"},C.default.createElement(v.ContextMenuTrigger,{id:"some_unique_identifier"},C.default.createElement(g.default,{showLine:!0,showIcon:!0,onSelect:this.onSelect,onRightClick:this.onRightClick,selectedKeys:u},C.default.createElement(_,{title:"\u83dc\u5355",key:"menu",icon:C.default.createElement(d.default,{type:"folder-open"})},n.map(function(t){return C.default.createElement(_,{title:t.subsys_id+t.subsys_name,key:t.subsys_id},e.getMenuTreeNode(t.subsys_id,"",a))})))),C.default.createElement(v.ContextMenu,{id:"some_unique_identifier"},this.getMenus(o))),C.default.createElement("div",{className:"contentinfo",style:{display:o>2||2==o&&"add"==this.state.edit?"block":"none"}},(0,b.default)((0,p.default)(t.prototype),"render",this).call(this)))}}]),t}(M.CommonInfoPage),I=(0,k.connect)(function(e){var t=e.moprs,n=e.mtsSubsys;return{moprs:t,mtsSubsys:n}})(l.default.create()(S));t.default=I}}]);